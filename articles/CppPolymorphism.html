<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cpp Polymorphism • FIMSTraining</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Cpp Polymorphism">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FIMSTraining</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file-contract fa-lg"></span>

    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/GettingToKnowCpp.html">Getting to Know C++</a>
    </li>
    <li>
      <a href="../articles/IntroRcpp.html">Intro to Rcpp</a>
    </li>
    <li>
      <a href="../articles/CppMemory.html">C++ Memory Management</a>
    </li>
    <li>
      <a href="../articles/TemplatedCpp">Templated C++</a>
    </li>
    <li>
      <a href="../articles/CppClassStructure">C++ Class Structure</a>
    </li>
    <li>
      <a href="../articles/CppInheritance">C++ Inheritance</a>
    </li>
    <li>
      <a href="../articles/CppPolymorphism">C++ Polymorphism</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/NOAA-FIMS/FIMS_Training/issues" class="external-link">
    <span class="fas fa-question-circle fa-lg"></span>

    Issues
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/NOAA-FIMS/FIMS_Training" class="external-link">
    <span class="fab fa-github fa-lg"></span>

    Source Code
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Cpp Polymorphism</h1>
                        <h4 data-toc-skip class="author">Andrea
Havron</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/NOAA-FIMS/FIMS_training/blob/main/vignettes/CppPolymorphism.Rmd" class="external-link"><code>vignettes/CppPolymorphism.Rmd</code></a></small>
      <div class="hidden name"><code>CppPolymorphism.Rmd</code></div>

    </div>

    
    
<p>In the <a href="https://noaa-fims.github.io/FIMS_training/articles/CppInheritance.html" class="external-link">C++
Inheritance</a> example, we saw how derived classes can inherit from
base classes. This example resulted in code that required
<code>if()</code> statements to calculate a function for the different
classes. Polymorphism can be used instead to specify different behaviors
for the different classes to avoid conditional statements in the code,
which are hard to maintain and extend.</p>
<div class="section level2">
<h2 id="c-polymorphism">C++ Polymorphism<a class="anchor" aria-label="anchor" href="#c-polymorphism"></a>
</h2>
<ul>
<li>a function or operator works different when used in different
context</li>
<li>can implement when classes inherit from each other</li>
<li>the result is a single action or function that produces different
results based on the derived class</li>
<li>
<strong>virtual</strong>: C++ function that gets overridden at
runtime</li>
</ul>
<p>Set up base class as before. This time, the shared object is the
function, <code>area()</code>. Note that the area function is proceeded
by <strong>virtual</strong> and set to equal 0. This is done to specify
this is a function being overwritten by functions from the child
class.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="kw">class</span> Shape <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="kw">public</span><span class="op">:</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="co">//constructor</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    Shape<span class="op">()</span> <span class="op">{}</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    </span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="kw">virtual</span> <span class="op">~</span>Shape<span class="op">()</span> <span class="op">{}</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    <span class="co">// Virtual function to calculate area</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="kw">virtual</span> <span class="dt">double</span> area<span class="op">()</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="op">};</span></span></code></pre></div>
<p>The child classes are then specified. Again, we use
<strong>virtual</strong> to indicate this function is overwriting the
function in the base class.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="kw">class</span> Circle <span class="op">:</span> <span class="kw">public</span> Shape <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="dt">double</span> radius<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="kw">public</span><span class="op">:</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    Circle<span class="op">(</span><span class="dt">double</span> r<span class="op">)</span> <span class="op">:</span> Shape<span class="op">(){</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>      radius <span class="op">=</span> r<span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="co">// Override area() for Circle</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="kw">virtual</span> <span class="dt">double</span> area<span class="op">()</span> <span class="op">{</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    <span class="cf">return</span> M_PI <span class="op">*</span> radius <span class="op">*</span> radius<span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="kw">class</span> Rectangle <span class="op">:</span> <span class="kw">public</span> Shape <span class="op">{</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>  <span class="kw">private</span><span class="op">:</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>    <span class="dt">double</span> length<span class="op">,</span> height<span class="op">;</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>  </span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>  <span class="kw">public</span><span class="op">:</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>    Rectangle<span class="op">(</span><span class="dt">double</span> l<span class="op">,</span> <span class="dt">double</span> h<span class="op">)</span> <span class="op">:</span> Shape<span class="op">(){</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>      length <span class="op">=</span> l<span class="op">;</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>      height <span class="op">=</span> h<span class="op">;</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>  </span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>  <span class="co">// Override area() for Rectangle</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>  <span class="kw">virtual</span> <span class="dt">double</span> area<span class="op">()</span>  <span class="op">{</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>    <span class="cf">return</span> length <span class="op">*</span> height<span class="op">;</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p>We are going to expose these functions to R using Rcpp Modules. See
<a href="https://noaa-fims.github.io/FIMS_training/articles/IntroRcpp.html#rcpp-modules" class="external-link">Intro
to Rcpp</a> for a refresher on Rcpp Modules.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>RCPP_MODULE<span class="op">(</span>shape<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  Rcpp<span class="op">::</span><span class="va">class_</span><span class="op">&lt;</span>Shape<span class="op">&gt;(</span><span class="st">"Shape"</span><span class="op">)</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="op">.</span>method<span class="op">(</span><span class="st">"area"</span><span class="op">,</span> <span class="op">&amp;</span>Shape<span class="op">::</span>area<span class="op">);</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  Rcpp<span class="op">::</span><span class="va">class_</span><span class="op">&lt;</span>Circle<span class="op">&gt;(</span><span class="st">"Circle"</span><span class="op">)</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="op">.</span>derives<span class="op">&lt;</span>Shape<span class="op">&gt;(</span><span class="st">"Shape"</span><span class="op">)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="op">.</span>constructor<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;();</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  Rcpp<span class="op">::</span><span class="va">class_</span><span class="op">&lt;</span>Rectangle<span class="op">&gt;(</span><span class="st">"Rectangle"</span><span class="op">)</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="op">.</span>derives<span class="op">&lt;</span>Shape<span class="op">&gt;(</span><span class="st">"Shape"</span><span class="op">)</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="op">.</span>constructor<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">double</span><span class="op">&gt;();</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Now we can load the module using <code><a href="https://rdrr.io/pkg/Rcpp/man/loadModule.html" class="external-link">Rcpp::loadModule()</a></code>
where the second argument is <code>TRUE</code> so that all objects are
loaded into the R environment. The ‘new’ functions creates a new
instance of the class.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rcpp.org" class="external-link">Rcpp</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Rcpp/man/sourceCpp.html" class="external-link">sourceCpp</a></span><span class="op">(</span><span class="st">"../src/my_polymorphism.cpp"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Rcpp/man/loadModule.html" class="external-link">loadModule</a></span><span class="op">(</span><span class="st">"shape"</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">Circle</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">Rectangle</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c</span><span class="op">$</span><span class="fu">area</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 12.56637</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span><span class="op">$</span><span class="fu">area</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 12</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andrea Havron, Christine Stawitz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
